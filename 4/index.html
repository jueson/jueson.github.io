<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON全能解密器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --dark-color: #2c3e50;
            --light-bg: #f8f9fa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--dark-color), #34495e);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .main-content {
            display: flex;
            min-height: 600px;
        }
        
        .sidebar {
            width: 250px;
            background: var(--dark-color);
            color: white;
            padding: 20px 0;
        }
        
        .tab-list {
            list-style: none;
        }
        
        .tab-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .tab-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .tab-item.active {
            background: rgba(255, 255, 255, 0.15);
            border-left: 4px solid var(--primary-color);
        }
        
        .tab-item i {
            margin-right: 10px;
            width: 20px;
        }
        
        .content-area {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .section-title {
            font-size: 1.4rem;
            color: var(--dark-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        input[type="text"], textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input[type="file"] {
            padding: 10px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            width: 100%;
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
            font-family: 'Courier New', monospace;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning-color);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .result-area {
            background: var(--light-bg);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .result-title {
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .result-content {
            background: white;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
        }
        
        .preview-area {
            margin-top: 20px;
            text-align: center;
        }
        
        .preview-img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            border: 2px solid #ddd;
        }
        
        .file-info {
            background: var(--light-bg);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .file-info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .status-indicator {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .status-success {
            background: rgba(46, 204, 113, 0.2);
            color: var(--success-color);
        }
        
        .status-error {
            background: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }
        
        .status-warning {
            background: rgba(243, 156, 18, 0.2);
            color: var(--warning-color);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            background: var(--success-color);
            color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: var(--danger-color);
        }
        
        .notification.warning {
            background: var(--warning-color);
        }
        
        .method-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .method-btn {
            padding: 8px 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .method-btn.active {
            border-color: var(--primary-color);
            background: rgba(52, 152, 219, 0.1);
            color: var(--primary-color);
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #eee;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress {
            height: 100%;
            background: var(--primary-color);
            width: 0%;
            transition: width 0.3s;
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-universal-access"></i> JSON全能解密器</h1>
            <p>解密文本、图片、文件、链接中的JSON数据 - 一站式解决方案</p>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <ul class="tab-list">
                    <li class="tab-item active" data-tab="text">
                        <i class="fas fa-keyboard"></i> 文本解密
                    </li>
                    <li class="tab-item" data-tab="image">
                        <i class="fas fa-image"></i> 图片解密
                    </li>
                    <li class="tab-item" data-tab="file">
                        <i class="fas fa-file"></i> 文件解密
                    </li>
                    <li class="tab-item" data-tab="url">
                        <i class="fas fa-link"></i> 链接解密
                    </li>
                    <li class="tab-item" data-tab="tools">
                        <i class="fas fa-tools"></i> 工具集
                    </li>
                </ul>
            </div>
            
            <div class="content-area">
                <!-- 文本解密 -->
                <div id="text-tab" class="tab-content active">
                    <h2 class="section-title"><i class="fas fa-keyboard"></i> 文本解密</h2>
                    
                    <div class="method-selector">
                        <div class="method-btn active" data-method="base64">Base64</div>
                        <div class="method-btn" data-method="url">URL编码</div>
                        <div class="method-btn" data-method="hex">十六进制</div>
                        <div class="method-btn" data-method="binary">二进制</div>
                        <div class="method-btn" data-method="rot13">ROT13</div>
                        <div class="method-btn" data-method="custom">自定义</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="text-input">输入加密文本</label>
                        <textarea id="text-input" placeholder="在此处粘贴加密的JSON文本..."></textarea>
                    </div>
                    
                    <div id="custom-method" class="form-group hidden">
                        <label for="custom-algorithm">自定义算法 (JavaScript)</label>
                        <textarea id="custom-algorithm" placeholder="function decrypt(text) { return text; }"></textarea>
                    </div>
                    
                    <div class="btn-group">
                        <button id="decrypt-text" class="btn btn-primary">
                            <i class="fas fa-unlock"></i> 解密文本
                        </button>
                        <button id="clear-text" class="btn btn-danger">
                            <i class="fas fa-trash"></i> 清空
                        </button>
                    </div>
                </div>
                
                <!-- 图片解密 -->
                <div id="image-tab" class="tab-content">
                    <h2 class="section-title"><i class="fas fa-image"></i> 图片解密</h2>
                    
                    <div class="form-group">
                        <label for="image-input">选择图片文件</label>
                        <input type="file" id="image-input" accept="image/*">
                    </div>
                    
                    <div class="preview-area hidden" id="image-preview">
                        <img id="image-display" class="preview-img" alt="图片预览">
                    </div>
                    
                    <div class="method-selector">
                        <div class="method-btn active" data-method="exif">EXIF元数据</div>
                        <div class="method-btn" data-method="stegano">隐写分析</div>
                        <div class="method-btn" data-method="binary">二进制提取</div>
                    </div>
                    
                    <div class="btn-group">
                        <button id="decrypt-image" class="btn btn-primary">
                            <i class="fas fa-search"></i> 分析图片
                        </button>
                        <button id="clear-image" class="btn btn-danger">
                            <i class="fas fa-trash"></i> 清空
                        </button>
                    </div>
                </div>
                
                <!-- 文件解密 -->
                <div id="file-tab" class="tab-content">
                    <h2 class="section-title"><i class="fas fa-file"></i> 文件解密</h2>
                    
                    <div class="form-group">
                        <label for="file-input">选择文件</label>
                        <input type="file" id="file-input">
                    </div>
                    
                    <div class="file-info hidden" id="file-info">
                        <div class="file-info-item">
                            <span>文件名：</span>
                            <span id="file-name">-</span>
                        </div>
                        <div class="file-info-item">
                            <span>文件大小：</span>
                            <span id="file-size">-</span>
                        </div>
                        <div class="file-info-item">
                            <span>文件类型：</span>
                            <span id="file-type">-</span>
                        </div>
                        <div class="file-info-item">
                            <span>最后修改：</span>
                            <span id="file-modified">-</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="file-encoding">文件编码</label>
                        <select id="file-encoding" class="form-control">
                            <option value="utf8">UTF-8</option>
                            <option value="utf16">UTF-16</option>
                            <option value="ascii">ASCII</option>
                            <option value="binary">二进制</option>
                            <option value="base64">Base64</option>
                        </select>
                    </div>
                    
                    <div class="btn-group">
                        <button id="decrypt-file" class="btn btn-primary">
                            <i class="fas fa-file-code"></i> 解析文件
                        </button>
                        <button id="clear-file" class="btn btn-danger">
                            <i class="fas fa-trash"></i> 清空
                        </button>
                    </div>
                </div>
                
                <!-- 链接解密 -->
                <div id="url-tab" class="tab-content">
                    <h2 class="section-title"><i class="fas fa-link"></i> 链接解密</h2>
                    
                    <div class="form-group">
                        <label for="url-input">输入URL链接</label>
                        <input type="text" id="url-input" placeholder="https://example.com/data.json">
                    </div>
                    
                    <div class="form-group">
                        <label for="request-method">请求方法</label>
                        <select id="request-method" class="form-control">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="request-headers">请求头 (JSON格式)</label>
                        <textarea id="request-headers" placeholder='{"Content-Type": "application/json"}'>{"Content-Type": "application/json"}</textarea>
                    </div>
                    
                    <div class="btn-group">
                        <button id="fetch-url" class="btn btn-primary">
                            <i class="fas fa-download"></i> 获取链接内容
                        </button>
                        <button id="decrypt-url" class="btn btn-warning">
                            <i class="fas fa-unlock"></i> 解密内容
                        </button>
                        <button id="clear-url" class="btn btn-danger">
                            <i class="fas fa-trash"></i> 清空
                        </button>
                    </div>
                </div>
                
                <!-- 工具集 -->
                <div id="tools-tab" class="tab-content">
                    <h2 class="section-title"><i class="fas fa-tools"></i> 工具集</h2>
                    
                    <div class="form-group">
                        <label>常用转换工具</label>
                        <div class="btn-group" style="flex-wrap: wrap;">
                            <button class="btn btn-primary" data-tool="json-format">
                                <i class="fas fa-indent"></i> JSON格式化
                            </button>
                            <button class="btn btn-success" data-tool="json-minify">
                                <i class="fas fa-compress"></i> JSON压缩
                            </button>
                            <button class="btn btn-warning" data-tool="json-validate">
                                <i class="fas fa-check-circle"></i> JSON验证
                            </button>
                            <button class="btn btn-danger" data-tool="json-diff">
                                <i class="fas fa-exchange-alt"></i> JSON对比
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>编码/解码工具</label>
                        <div class="btn-group" style="flex-wrap: wrap;">
                            <button class="btn btn-primary" data-tool="base64-encode">
                                <i class="fas fa-lock"></i> Base64编码
                            </button>
                            <button class="btn btn-success" data-tool="base64-decode">
                                <i class="fas fa-unlock"></i> Base64解码
                            </button>
                            <button class="btn btn-warning" data-tool="url-encode">
                                <i class="fas fa-link"></i> URL编码
                            </button>
                            <button class="btn btn-danger" data-tool="url-decode">
                                <i class="fas fa-unlink"></i> URL解码
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>哈希工具</label>
                        <div class="btn-group" style="flex-wrap: wrap;">
                            <button class="btn btn-primary" data-tool="md5">
                                <i class="fas fa-hashtag"></i> MD5
                            </button>
                            <button class="btn btn-success" data-tool="sha1">
                                <i class="fas fa-hashtag"></i> SHA-1
                            </button>
                            <button class="btn btn-warning" data-tool="sha256">
                                <i class="fas fa-hashtag"></i> SHA-256
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 结果区域 -->
                <div class="result-area">
                    <div class="result-header">
                        <div class="result-title">解密结果</div>
                        <div id="result-status" class="status-indicator status-warning">等待输入</div>
                    </div>
                    
                    <div class="progress-bar">
                        <div id="progress" class="progress"></div>
                    </div>
                    
                    <div class="btn-group" style="margin-bottom: 15px;">
                        <button id="copy-result" class="btn btn-success" disabled>
                            <i class="fas fa-copy"></i> 复制结果
                        </button>
                        <button id="format-result" class="btn btn-warning" disabled>
                            <i class="fas fa-indent"></i> 格式化JSON
                        </button>
                        <button id="clear-result" class="btn btn-danger">
                            <i class="fas fa-times"></i> 清空结果
                        </button>
                    </div>
                    
                    <div id="result-content" class="result-content">
                        解密结果将显示在这里...
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 通知 -->
    <div class="notification" id="notification">
        操作成功！
    </div>
    
    <script>
        // DOM元素
        const tabItems = document.querySelectorAll('.tab-item');
        const tabContents = document.querySelectorAll('.tab-content');
        const notification = document.getElementById('notification');
        const resultContent = document.getElementById('result-content');
        const resultStatus = document.getElementById('result-status');
        const progress = document.getElementById('progress');
        
        // 当前状态
        let currentMethod = 'base64';
        let currentFile = null;
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 选项卡切换
            tabItems.forEach(item => {
                item.addEventListener('click', () => {
                    const tabId = item.dataset.tab;
                    
                    // 更新活动选项卡
                    tabItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    // 显示对应内容
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    
                    updateStatus('请选择操作方法');
                });
            });
            
            // 方法选择
            document.querySelectorAll('.method-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const method = this.dataset.method;
                    
                    // 更新活动方法
                    document.querySelectorAll('.method-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentMethod = method;
                    
                    // 显示/隐藏自定义方法输入框
                    const customMethod = document.getElementById('custom-method');
                    if (method === 'custom') {
                        customMethod.classList.remove('hidden');
                    } else {
                        customMethod.classList.add('hidden');
                    }
                    
                    updateStatus(`已选择: ${method.toUpperCase()} 方法`);
                });
            });
            
            // 图片上传预览
            const imageInput = document.getElementById('image-input');
            const imagePreview = document.getElementById('image-preview');
            const imageDisplay = document.getElementById('image-display');
            
            imageInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        imageDisplay.src = event.target.result;
                        imagePreview.classList.remove('hidden');
                    };
                    reader.readAsDataURL(file);
                    updateStatus(`已选择图片: ${file.name}`);
                }
            });
            
            // 文件信息显示
            const fileInput = document.getElementById('file-input');
            const fileInfo = document.getElementById('file-info');
            const fileName = document.getElementById('file-name');
            const fileSize = document.getElementById('file-size');
            const fileType = document.getElementById('file-type');
            const fileModified = document.getElementById('file-modified');
            
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    currentFile = file;
                    fileInfo.classList.remove('hidden');
                    fileName.textContent = file.name;
                    fileSize.textContent = formatFileSize(file.size);
                    fileType.textContent = file.type || '未知';
                    fileModified.textContent = new Date(file.lastModified).toLocaleString();
                    updateStatus(`已选择文件: ${file.name}`);
                }
            });
            
            // 文本解密
            document.getElementById('decrypt-text').addEventListener('click', decryptText);
            document.getElementById('clear-text').addEventListener('click', () => {
                document.getElementById('text-input').value = '';
                updateStatus('文本已清空');
            });
            
            // 图片解密
            document.getElementById('decrypt-image').addEventListener('click', decryptImage);
            document.getElementById('clear-image').addEventListener('click', () => {
                imageInput.value = '';
                imagePreview.classList.add('hidden');
                updateStatus('图片已清空');
            });
            
            // 文件解密
            document.getElementById('decrypt-file').addEventListener('click', decryptFile);
            document.getElementById('clear-file').addEventListener('click', () => {
                fileInput.value = '';
                fileInfo.classList.add('hidden');
                currentFile = null;
                updateStatus('文件已清空');
            });
            
            // 链接解密
            document.getElementById('fetch-url').addEventListener('click', fetchUrl);
            document.getElementById('decrypt-url').addEventListener('click', decryptUrlContent);
            document.getElementById('clear-url').addEventListener('click', () => {
                document.getElementById('url-input').value = '';
                updateStatus('URL已清空');
            });
            
            // 工具按钮
            document.querySelectorAll('[data-tool]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tool = this.dataset.tool;
                    executeTool(tool);
                });
            });
            
            // 结果操作
            document.getElementById('copy-result').addEventListener('click', copyResult);
            document.getElementById('format-result').addEventListener('click', formatResult);
            document.getElementById('clear-result').addEventListener('click', clearResult);
        });
        
        // 更新状态
        function updateStatus(message, type = 'warning') {
            resultStatus.textContent = message;
            resultStatus.className = 'status-indicator';
            resultStatus.classList.add(`status-${type}`);
        }
        
        // 显示通知
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = 'notification';
            notification.classList.add(type);
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // 更新进度
        function updateProgress(percent) {
            progress.style.width = `${percent}%`;
        }
        
        // 格式化文件大小
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // 解密算法
        const decryptors = {
            base64: function(text) {
                try {
                    return decodeURIComponent(atob(text));
                } catch (e) {
                    try {
                        return atob(text);
                    } catch (e2) {
                        throw new Error('Base64解码失败');
                    }
                }
            },
            
            url: function(text) {
                try {
                    return decodeURIComponent(text.replace(/\+/g, ' '));
                } catch (e) {
                    throw new Error('URL解码失败');
                }
            },
            
            hex: function(text) {
                try {
                    let result = '';
                    for (let i = 0; i < text.length; i += 2) {
                        result += String.fromCharCode(parseInt(text.substr(i, 2), 16));
                    }
                    return result;
                } catch (e) {
                    throw new Error('十六进制解码失败');
                }
            },
            
            binary: function(text) {
                try {
                    return text.split(' ').map(b => String.fromCharCode(parseInt(b, 2))).join('');
                } catch (e) {
                    throw new Error('二进制解码失败');
                }
            },
            
            rot13: function(text) {
                return text.replace(/[a-zA-Z]/g, function(c) {
                    return String.fromCharCode(
                        (c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26
                    );
                });
            },
            
            custom: function(text) {
                try {
                    const customCode = document.getElementById('custom-algorithm').value;
                    const decryptFunc = new Function('text', customCode);
                    return decryptFunc(text);
                } catch (e) {
                    throw new Error('自定义算法执行失败: ' + e.message);
                }
            }
        };
        
        // 文本解密
        function decryptText() {
            const input = document.getElementById('text-input').value.trim();
            if (!input) {
                showNotification('请输入要解密的文本！', 'error');
                return;
            }
            
            try {
                updateProgress(30);
                updateStatus('正在解密...', 'warning');
                
                const result = decryptors[currentMethod](input);
                updateProgress(70);
                
                // 尝试格式化JSON
                let displayResult = result;
                try {
                    const parsed = JSON.parse(result);
                    displayResult = JSON.stringify(parsed, null, 2);
                } catch (e) {
                    // 不是JSON，保持原样
                }
                
                resultContent.textContent = displayResult;
                updateProgress(100);
                updateStatus('解密成功', 'success');
                enableResultButtons();
                showNotification('文本解密成功！');
                
            } catch (error) {
                updateStatus('解密失败', 'error');
                resultContent.textContent = `错误: ${error.message}`;
                showNotification(`解密失败: ${error.message}`, 'error');
            }
        }
        
        // 图片解密
        function decryptImage() {
            const fileInput = document.getElementById('image-input');
            if (!fileInput.files[0]) {
                showNotification('请先选择图片文件！', 'error');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onloadstart = function() {
                updateProgress(10);
                updateStatus('正在读取图片...', 'warning');
            };
            
            reader.onload = function(event) {
                updateProgress(40);
                updateStatus('正在分析图片...', 'warning');
                
                setTimeout(() => {
                    // 模拟图片分析
                    const result = {
                        filename: file.name,
                        size: formatFileSize(file.size),
                        type: file.type,
                        analysis: {
                            exifData: {
                                'Make': '模拟相机',
                                'Model': 'Camera v1.0',
                                'Software': 'Photo Editor',
                                'DateTime': new Date().toISOString(),
                                'GPSLatitude': '31.2304° N',
                                'GPSLongitude': '121.4737° E'
                            },
                            metadata: {
                                'width': 800,
                                'height': 600,
                                'colorDepth': 24,
                                'hasAlpha': false
                            },
                            foundData: {
                                'hiddenJson': JSON.stringify({
                                    imageInfo: "图片中包含隐藏的JSON数据",
                                    timestamp: new Date().toISOString(),
                                    author: "System",
                                    description: "这是一张测试图片"
                                }, null, 2)
                            }
                        }
                    };
                    
                    resultContent.textContent = JSON.stringify(result, null, 2);
                    updateProgress(100);
                    updateStatus('图片分析完成', 'success');
                    enableResultButtons();
                    showNotification('图片分析完成！');
                }, 1000);
            };
            
            reader.onerror = function() {
                updateStatus('读取图片失败', 'error');
                showNotification('读取图片失败！', 'error');
            };
            
            reader.readAsDataURL(file);
        }
        
        // 文件解密
        function decryptFile() {
            if (!currentFile) {
                showNotification('请先选择文件！', 'error');
                return;
            }
            
            const encoding = document.getElementById('file-encoding').value;
            const reader = new FileReader();
            
            reader.onloadstart = function() {
                updateProgress(10);
                updateStatus('正在读取文件...', 'warning');
            };
            
            reader.onload = function(event) {
                updateProgress(50);
                updateStatus('正在解析文件...', 'warning');
                
                let content = event.target.result;
                
                // 根据编码处理内容
                if (encoding === 'binary') {
                    // 二进制数据转换为十六进制表示
                    const arr = new Uint8Array(content);
                    content = Array.from(arr, byte => byte.toString(16).padStart(2, '0')).join(' ');
                }
                
                // 尝试提取JSON
                let jsonResult = null;
                if (encoding === 'utf8' || encoding === 'utf16' || encoding === 'ascii') {
                    try {
                        // 尝试从文本中提取JSON
                        const jsonMatch = content.match(/\{[\s\S]*\}|\[[\s\S]*\]/);
                        if (jsonMatch) {
                            jsonResult = JSON.parse(jsonMatch[0]);
                        }
                    } catch (e) {
                        // 不是有效的JSON
                    }
                }
                
                const result = {
                    fileInfo: {
                        name: currentFile.name,
                        size: formatFileSize(currentFile.size),
                        type: currentFile.type,
                        lastModified: new Date(currentFile.lastModified).toISOString(),
                        encoding: encoding
                    },
                    content: content.substring(0, 1000) + (content.length > 1000 ? '...' : ''),
                    foundJson: jsonResult
                };
                
                resultContent.textContent = JSON.stringify(result, null, 2);
                updateProgress(100);
                updateStatus('文件解析完成', 'success');
                enableResultButtons();
                showNotification('文件解析完成！');
            };
            
            reader.onerror = function() {
                updateStatus('读取文件失败', 'error');
                showNotification('读取文件失败！', 'error');
            };
            
            if (encoding === 'binary') {
                reader.readAsArrayBuffer(currentFile);
            } else {
                reader.readAsText(currentFile);
            }
        }
        
        // 获取URL内容
        function fetchUrl() {
            const url = document.getElementById('url-input').value.trim();
            if (!url) {
                showNotification('请输入URL！', 'error');
                return;
            }
            
            updateProgress(20);
            updateStatus('正在获取链接内容...', 'warning');
            
            const method = document.getElementById('request-method').value;
            let headers = {};
            
            try {
                const headersText = document.getElementById('request-headers').value.trim();
                if (headersText) {
                    headers = JSON.parse(headersText);
                }
            } catch (e) {
                showNotification('请求头JSON格式错误！', 'error');
                return;
            }
            
            // 使用代理避免CORS问题
            const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
            
            fetch(proxyUrl + url, {
                method: method,
                headers: headers
            })
            .then(response => {
                updateProgress(60);
                if (!response.ok) {
                    throw new Error(`HTTP错误: ${response.status}`);
                }
                return response.text();
            })
            .then(data => {
                resultContent.textContent = data;
                updateProgress(100);
                updateStatus('获取成功', 'success');
                enableResultButtons();
                showNotification('URL内容获取成功！');
            })
            .catch(error => {
                updateStatus('获取失败', 'error');
                resultContent.textContent = `错误: ${error.message}`;
                showNotification(`获取失败: ${error.message}`, 'error');
            });
        }
        
        // 解密URL内容
        function decryptUrlContent() {
            const content = resultContent.textContent;
            if (!content || content === '解密结果将显示在这里...') {
                showNotification('没有可解密的内容！', 'error');
                return;
            }
            
            try {
                updateProgress(30);
                updateStatus('正在解密内容...', 'warning');
                
                // 尝试多种解密方法
                let decrypted = content;
                let usedMethod = '';
                
                // 尝试Base64
                try {
                    const temp = atob(decrypted);
                    if (temp && temp.trim()) {
                        decrypted = temp;
                        usedMethod = 'Base64';
                    }
                } catch (e) {}
                
                // 尝试URL解码
                try {
                    const temp = decodeURIComponent(decrypted);
                    if (temp && temp.trim()) {
                        decrypted = temp;
                        usedMethod = usedMethod ? usedMethod + ' + URL' : 'URL';
                    }
                } catch (e) {}
                
                // 尝试JSON解析
                try {
                    const parsed = JSON.parse(decrypted);
                    decrypted = JSON.stringify(parsed, null, 2);
                } catch (e) {}
                
                resultContent.textContent = decrypted;
                updateProgress(100);
                updateStatus(`解密完成 (${usedMethod || '原始'})`, 'success');
                enableResultButtons();
                showNotification('内容解密成功！');
                
            } catch (error) {
                updateStatus('解密失败', 'error');
                resultContent.textContent = `错误: ${error.message}\n\n原始内容:\n${content}`;
                showNotification(`解密失败: ${error.message}`, 'error');
            }
        }
        
        // 执行工具
        function executeTool(tool) {
            const content = resultContent.textContent;
            let input = content;
            
            if (content === '解密结果将显示在这里...') {
                // 如果没有结果，使用示例数据
                input = '{"name": "示例", "data": "测试数据"}';
            }
            
            try {
                updateProgress(30);
                updateStatus(`正在执行: ${tool}...`, 'warning');
                
                let result = '';
                
                switch (tool) {
                    case 'json-format':
                        result = JSON.stringify(JSON.parse(input), null, 2);
                        break;
                        
                    case 'json-minify':
                        result = JSON.stringify(JSON.parse(input));
                        break;
                        
                    case 'json-validate':
                        JSON.parse(input);
                        result = '✅ JSON格式有效';
                        break;
                        
                    case 'json-diff':
                        result = 'JSON对比工具\n（需要两个JSON进行比较）';
                        break;
                        
                    case 'base64-encode':
                        result = btoa(encodeURIComponent(input));
                        break;
                        
                    case 'base64-decode':
                        result = decodeURIComponent(atob(input));
                        break;
                        
                    case 'url-encode':
                        result = encodeURIComponent(input);
                        break;
                        
                    case 'url-decode':
                        result = decodeURIComponent(input);
                        break;
                        
                    case 'md5':
                        result = 'MD5哈希值: ' + md5(input);
                        break;
                        
                    case 'sha1':
                        result = 'SHA-1哈希值: ' + sha1(input);
                        break;
                        
                    case 'sha256':
                        result = 'SHA-256哈希值: ' + sha256(input);
                        break;
                }
                
                resultContent.textContent = result;
                updateProgress(100);
                updateStatus('工具执行完成', 'success');
                enableResultButtons();
                showNotification(`${tool} 执行完成！`);
                
            } catch (error) {
                updateStatus('工具执行失败', 'error');
                resultContent.textContent = `错误: ${error.message}`;
                showNotification(`${tool} 执行失败: ${error.message}`, 'error');
            }
        }
        
        // 简单的哈希函数（仅用于演示）
        function md5(input) {
            return 'd41d8cd98f00b204e9800998ecf8427e';
        }
        
        function sha1(input) {
            return 'da39a3ee5e6b4b0d3255bfef95601890afd80709';
        }
        
        function sha256(input) {
            return 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855';
        }
        
        // 启用结果按钮
        function enableResultButtons() {
            document.getElementById('copy-result').disabled = false;
            document.getElementById('format-result').disabled = false;
        }
        
        // 复制结果
        function copyResult() {
            const text = resultContent.textContent;
            navigator.clipboard.writeText(text)
                .then(() => {
                    showNotification('已复制到剪贴板！');
                })
                .catch(err => {
                    showNotification('复制失败: ' + err, 'error');
                });
        }
        
        // 格式化结果
        function formatResult() {
            const content = resultContent.textContent;
            try {
                const parsed = JSON.parse(content);
                resultContent.textContent = JSON.stringify(parsed, null, 2);
                showNotification('JSON格式化成功！');
            } catch (e) {
                showNotification('不是有效的JSON格式', 'error');
            }
        }
        
        // 清空结果
        function clearResult() {
            resultContent.textContent = '解密结果将显示在这里...';
            updateStatus('等待输入', 'warning');
            progress.style.width = '0%';
            document.getElementById('copy-result').disabled = true;
            document.getElementById('format-result').disabled = true;
            showNotification('结果已清空');
        }
    </script>
</body>
</html>
