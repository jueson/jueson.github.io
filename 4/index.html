<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>全能接口解密</title>
    <!-- 引入Bootstrap 5样式库 -->
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.0.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- 引入Font Awesome图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
        }
        
        body {
            margin-top: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        .main-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #333;
            font-weight: 600;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(52, 152, 219, 0.25);
        }
        
        .btn {
            border-radius: 8px;
            padding: 12px 25px;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-secondary {
            background: var(--primary-color);
            border: none;
        }
        
        .btn-warning {
            background: var(--warning-color);
            border: none;
        }
        
        .btn-danger {
            background: var(--danger-color);
            border: none;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .loading {
            display: none;
            margin: 20px auto;
            text-align: center;
        }
        
        textarea.form-control {
            min-height: 300px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            resize: vertical;
            margin-top: 20px;
        }
        
        .decryption-methods {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .method-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }
        
        .method-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .method-btn {
            padding: 8px 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .method-btn.active {
            border-color: var(--primary-color);
            background: rgba(52, 152, 219, 0.1);
            color: var(--primary-color);
        }
        
        .method-btn:hover {
            border-color: var(--primary-color);
        }
        
        .result-info {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .info-label {
            color: #666;
        }
        
        .info-value {
            font-weight: 600;
            color: #333;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .badge-success {
            background: rgba(46, 204, 113, 0.2);
            color: #27ae60;
        }
        
        .badge-error {
            background: rgba(231, 76, 60, 0.2);
            color: #c0392b;
        }
        
        .badge-warning {
            background: rgba(243, 156, 18, 0.2);
            color: #d35400;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            background: #2ecc71;
            color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: var(--danger-color);
        }
        
        .notification.warning {
            background: var(--warning-color);
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        @media (max-width: 768px) {
            .container {
                max-width: 100%;
            }
            
            .method-buttons {
                flex-direction: column;
            }
            
            .method-btn {
                width: 100%;
            }
            
            .footer-links {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-card">
            <h1 class="text-center mb-4">
                <i class="fas fa-unlock-alt me-2"></i>全能接口解密
            </h1>
            
            <div class="input-group mb-3">
                <input type="text" class="form-control" id="url" value="" placeholder="输入接口地址，没地址？饭太硬主页有">
                <button class="btn btn-secondary" type="button" onclick="decrypt()">
                    <i class="fas fa-unlock me-2"></i>解密
                </button>
            </div>
            
            <!-- 解密方法选择 -->
            <div class="decryption-methods">
                <div class="method-title">解密方法：</div>
                <div class="method-buttons">
                    <div class="method-btn active" data-method="auto">自动识别</div>
                    <div class="method-btn" data-method="base64">Base64</div>
                    <div class="method-btn" data-method="url">URL编码</div>
                    <div class="method-btn" data-method="hex">十六进制</div>
                    <div class="method-btn" data-method="binary">二进制</div>
                    <div class="method-btn" data-method="rot13">ROT13</div>
                </div>
            </div>
           
            <div class="text-center loading" id="loading">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">加载中...</span>
                </div>
                <p class="mt-2">正在解密中...</p>
            </div>
           
            <textarea class="form-control" id="result" cols="80" rows="20" readonly></textarea>
            
            <!-- 结果信息 -->
            <div class="result-info" id="result-info" style="display: none;">
                <div class="info-item">
                    <span class="info-label">解密状态：</span>
                    <span id="status" class="status-badge badge-warning">等待解密</span>
                </div>
                <div class="info-item">
                    <span class="info-label">解密方法：</span>
                    <span id="method-used" class="info-value">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">输入长度：</span>
                    <span id="input-length" class="info-value">0</span>
                </div>
                <div class="info-item">
                    <span class="info-label">输出长度：</span>
                    <span id="output-length" class="info-value">0</span>
                </div>
                <div class="info-item">
                    <span class="info-label">处理时间：</span>
                    <span id="process-time" class="info-value">-</span>
                </div>
            </div>
            
            <div class="footer-links mt-4">
                <a href="/" target="_blank" class="btn btn-primary">
                    <i class="fas fa-home me-2"></i>主页
                </a>
                <button class="btn btn-warning" onclick="copyText()">
                    <i class="fas fa-copy me-2"></i>复制
                </button>
                <button class="btn btn-success" onclick="downloadJar()">
                    <i class="fas fa-download me-2"></i>下载Jar
                </button>
                <a href="https://mp.weixin.qq.com/s/Fh-tquauHTU3n97Uc0JF0g" target="_blank" class="btn btn-danger">
                    <i class="fab fa-weixin me-2"></i>饭太硬公众号
                </a>
                <button class="btn btn-outline-secondary" onclick="clearAll()">
                    <i class="fas fa-trash me-2"></i>清空
                </button>
            </div>
        </div>
    </div>
    
    <!-- 通知区域 -->
    <div class="notification" id="notification">操作成功！</div>
    
    <!-- 引入Bootstrap JS库 -->
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.0.0/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // 解密方法
        let currentMethod = 'auto';
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 设置方法选择事件
            document.querySelectorAll('.method-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.method-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentMethod = this.dataset.method;
                    showNotification(`已选择: ${this.textContent} 解密方法`);
                });
            });
            
            // 更新输入长度
            document.getElementById('url').addEventListener('input', function() {
                document.getElementById('input-length').textContent = this.value.length;
            });
        });
        
        // 显示通知
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification';
            notification.classList.add(type);
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // 解密函数
        function decrypt() {
            const startTime = performance.now();
            const url = document.getElementById('url').value.trim();
            const resultBox = document.getElementById('result');
            const loading = document.getElementById('loading');
            const resultInfo = document.getElementById('result-info');
            
            if (!url) {
                showNotification('请输入要解密的URL！', 'warning');
                return;
            }
            
            // 显示加载
            resultBox.value = '';
            loading.style.display = 'block';
            resultInfo.style.display = 'none';
            document.getElementById('status').className = 'status-badge badge-warning';
            document.getElementById('status').textContent = '正在解密...';
            
            // 如果是URL，尝试获取内容
            if (url.startsWith('http://') || url.startsWith('https://')) {
                fetchUrlContent(url);
            } else {
                // 直接处理文本
                processContent(url, 'text');
            }
            
            function fetchUrlContent(url) {
                // 使用CORS代理避免跨域问题
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                
                fetch(proxyUrl + url, {
                    headers: {
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP错误: ${response.status}`);
                    }
                    return response.text();
                })
                .then(data => {
                    const endTime = performance.now();
                    processContent(data, 'url');
                    loading.style.display = 'none';
                    
                    // 更新信息
                    document.getElementById('process-time').textContent = `${(endTime - startTime).toFixed(2)}ms`;
                })
                .catch(error => {
                    loading.style.display = 'none';
                    resultBox.value = `获取URL内容失败: ${error.message}\n\n尝试直接解密输入的文本...`;
                    
                    // 尝试直接解密输入的内容
                    processContent(url, 'text');
                });
            }
            
            function processContent(content, sourceType) {
                try {
                    let result = content;
                    let methodUsed = currentMethod;
                    
                    // 自动识别方法
                    if (currentMethod === 'auto') {
                        methodUsed = detectDecryptionMethod(content);
                    }
                    
                    // 应用解密方法
                    result = applyDecryption(result, methodUsed);
                    
                    // 尝试格式化JSON
                    let formattedResult = result;
                    try {
                        const parsed = JSON.parse(result);
                        formattedResult = JSON.stringify(parsed, null, 2);
                    } catch (e) {
                        // 不是JSON，保持原样
                    }
                    
                    // 显示结果
                    resultBox.value = formattedResult;
                    
                    // 更新信息
                    const endTime = performance.now();
                    document.getElementById('method-used').textContent = methodUsed;
                    document.getElementById('output-length').textContent = result.length;
                    document.getElementById('status').className = 'status-badge badge-success';
                    document.getElementById('status').textContent = '解密成功';
                    document.getElementById('process-time').textContent = `${(endTime - startTime).toFixed(2)}ms`;
                    
                    resultInfo.style.display = 'block';
                    showNotification('解密成功！');
                    
                } catch (error) {
                    loading.style.display = 'none';
                    resultBox.value = `解密失败: ${error.message}\n\n原始内容:\n${content}`;
                    
                    document.getElementById('status').className = 'status-badge badge-error';
                    document.getElementById('status').textContent = '解密失败';
                    resultInfo.style.display = 'block';
                    
                    showNotification(`解密失败: ${error.message}`, 'error');
                }
            }
        }
        
        // 检测解密方法
        function detectDecryptionMethod(text) {
            // 检测Base64
            try {
                const base64Regex = /^[A-Za-z0-9+/]+={0,2}$/;
                if (base64Regex.test(text.trim()) && text.length % 4 === 0) {
                    return 'base64';
                }
            } catch (e) {}
            
            // 检测URL编码
            if (text.includes('%')) {
                const urlEncodedRegex = /%[0-9A-Fa-f]{2}/;
                if (urlEncodedRegex.test(text)) {
                    return 'url';
                }
            }
            
            // 检测十六进制
            const hexRegex = /^[0-9A-Fa-f\s]+$/;
            if (hexRegex.test(text.replace(/ /g, ''))) {
                return 'hex';
            }
            
            // 检测二进制
            const binaryRegex = /^[01\s]+$/;
            if (binaryRegex.test(text.replace(/ /g, ''))) {
                return 'binary';
            }
            
            // 默认使用Base64
            return 'base64';
        }
        
        // 应用解密
        function applyDecryption(text, method) {
            switch (method) {
                case 'base64':
                    return base64Decode(text);
                case 'url':
                    return urlDecode(text);
                case 'hex':
                    return hexDecode(text);
                case 'binary':
                    return binaryDecode(text);
                case 'rot13':
                    return rot13Decode(text);
                default:
                    return text;
            }
        }
        
        // Base64解码
        function base64Decode(str) {
            try {
                return decodeURIComponent(atob(str));
            } catch (e) {
                try {
                    return atob(str);
                } catch (e2) {
                    throw new Error('Base64解码失败');
                }
            }
        }
        
        // URL解码
        function urlDecode(str) {
            try {
                return decodeURIComponent(str.replace(/\+/g, ' '));
            } catch (e) {
                throw new Error('URL解码失败');
            }
        }
        
        // 十六进制解码
        function hexDecode(str) {
            try {
                let hex = str.replace(/\s/g, '');
                let result = '';
                for (let i = 0; i < hex.length; i += 2) {
                    result += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
                }
                return result;
            } catch (e) {
                throw new Error('十六进制解码失败');
            }
        }
        
        // 二进制解码
        function binaryDecode(str) {
            try {
                return str.split(' ').map(bin => {
                    return String.fromCharCode(parseInt(bin, 2));
                }).join('');
            } catch (e) {
                throw new Error('二进制解码失败');
            }
        }
        
        // ROT13解码
        function rot13Decode(str) {
            return str.replace(/[a-zA-Z]/g, function(c) {
                return String.fromCharCode(
                    (c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26
                );
            });
        }
        
        // 复制文本
        function copyText() {
            const copyText = document.getElementById("result");
            copyText.select();
            copyText.setSelectionRange(0, 99999);
            document.execCommand("copy");
            showNotification("复制成功！");
        }
        
        // 下载Jar文件
        function downloadJar() {
            const resultBox = document.getElementById("result");
            const content = resultBox.value;
            
            // 尝试从结果中提取spider字段
            const spiderMatch = content.match(/"spider"\s*:\s*"([^"]+)"/);
            if (!spiderMatch) {
                showNotification("未找到spider字段！", 'warning');
                return;
            }
            
            let url = spiderMatch[1];
            if (url.includes(';md5;')) {
                url = url.split(';md5;')[0];
            }
            
            // 显示加载
            const loading = document.getElementById('loading');
            loading.style.display = 'block';
            
            // 下载文件
            fetch(url, {
                headers: {
                    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                }
            })
            .then(response => response.blob())
            .then(blob => {
                const downloadUrl = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = downloadUrl;
                a.download = 'file.jar';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(downloadUrl);
                loading.style.display = 'none';
                showNotification("文件下载开始！");
            })
            .catch(error => {
                loading.style.display = 'none';
                showNotification(`下载失败: ${error.message}`, 'error');
            });
        }
        
        // 清空所有
        function clearAll() {
            document.getElementById('url').value = '';
            document.getElementById('result').value = '';
            document.getElementById('result-info').style.display = 'none';
            document.getElementById('input-length').textContent = '0';
            showNotification("已清空所有内容");
        }
    </script>
</body>
</html>
